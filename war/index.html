<!doctype>
<html>
<head>
<script type="text/javascript">
	function onLoad(){

		function card() {
			this.kolor;
			this.wartosc;
		}

		var talia = new Array;

		for (var i=1;i<=4;i++){
			for (var j=2;j<=14;j++){
				var karta = new card();
				
				karta.wartosc = j;
				karta.kolor = i;
				talia.push(karta);

				switch(karta.wartosc)
				{
					case 11:
						karta.wartoscS = "jack";
						break;
					case 12:
						karta.wartoscS = "queen";
						break;
					case 13:
						karta.wartoscS = "king";
						break;
					case 14:
						karta.wartoscS = "ace";
						break;
					default:
						karta.wartoscS = karta.wartosc;
						break;
				}

				switch(karta.kolor)
				{
					case 1:
						karta.kolor = "hearts";
						break;
					case 2:
						karta.kolor = "diamonds";
						break;
					case 3:
						karta.kolor = "spades";
						break;
					case 4:
						karta.kolor = "clubs";
						break;
				}
			}	
		}

		primitive_shuffle(talia);
		//render(talia);
		
		var deck1 = new Array;
		var deck2 = new Array;

		for(var i=0;i<talia.length;i++)
		{
			if(i%2==0)
			{
				deck1.push(talia[i])
			}
			else{
				deck2.push(talia[i])
			}
		}
		//karty rozdane, czas na gre
		var chuj = 0;

		
		document.getElementById("decki").innerHTML= "chujkruwa";
		var lecimy_tutaj =	setInterval(function()
			{
				if (deck1.length < 1 || deck2.length < 1)
				{
					chuj = 1;
					console.log("end");					
				}



			
				document.getElementById("decki").innerHTML="";
				document.getElementById("decki").innerHTML+="D1:";
				for(var i=0;i < deck1.length;i++){
					document.getElementById("decki").innerHTML +="<img src=gfx/"+deck1[i].wartoscS+"_of_"+deck1[i].kolor+".png width='40px' >" ;
				}
				document.getElementById("decki").innerHTML+="<br><br>";
				document.getElementById("decki").innerHTML+="D2:";
				for(var i=0;i < deck2.length;i++){
					document.getElementById("decki").innerHTML +="<img src=gfx/"+deck2[i].wartoscS+"_of_"+deck2[i].kolor+".png width='40px' >" ;
				}
				
				if(chuj!=1){
				/*document.body.innerHTML += "<img src=gfx/"+deck1[chuj].wartoscS+"_of_"+deck1[chuj].kolor+".png width='100px' > VS";
				document.body.innerHTML += "<img src=gfx/"+deck2[chuj].wartoscS+"_of_"+deck2[chuj].kolor+".png width='100px' ><br>"
				*/

			if(deck1[chuj].wartosc == deck2[chuj].wartosc)
			{
				if(deck1.length < 4 || deck2.length < 4){
					var temp = deck2[chuj];
					deck2.push(temp);
					deck2.splice(chuj,chuj+1);
					deck1.push(deck1[chuj]);
					deck1.splice(chuj,chuj+1);
					console.log("wojna maÅ‚a");
				}
				else{
					if(deck1[chuj+2].wartosc == deck2[chuj+2].wartosc)
					{
						console.log("podwojna wojna ");
						// podwojna wojna
						var temp = deck2[chuj];
						deck2.push(temp);
						deck2.splice(chuj,chuj+1);
						deck1.push(deck1[chuj]);
						deck1.splice(chuj,chuj+1);
					}		
					else if(deck1[chuj+2].wartosc > deck2[chuj+2].wartosc)
					{
						var temp = deck2[chuj];
						var temp2 = deck2[chuj+1]
						var temp3 = deck2[chuj+2]
						deck1.push(temp);
						deck1.push(temp2);
						deck1.push(temp3);
						deck1.push(deck1[chuj+1])
						deck1.push(deck1[chuj+2])
						deck1.push(deck1[chuj]);
						deck2.splice(chuj,chuj+3);
						deck1.splice(chuj,chuj+3);
					}
					else if(deck1[chuj+2].wartosc < deck2[chuj+2].wartosc){
						var temp = deck1[chuj];
						var temp2 = deck1[chuj+1]
						var temp3 = deck1[chuj+2]
						deck2.push(temp);
						deck2.push(temp2);
						deck2.push(temp3);
						deck2.push(deck2[chuj+1])
						deck2.push(deck2[chuj+2])
						deck2.push(deck2[chuj]);
						deck1.splice(chuj,chuj+3);
						deck2.splice(chuj,chuj+3);
					}
					else{
						console.log("wtf2");
					}
				}

			}
			else if(deck1[chuj].wartosc > deck2[chuj].wartosc)
			{
				
				//usuwanie z deck2, push do deck1
				//usuniecie aktualnej z deck1 i dodanie go na koniec

				var temp = deck2[chuj];
				deck1.push(temp);
				deck2.splice(chuj,chuj+1);
				deck1.push(deck1[chuj]);
				deck1.splice(chuj,chuj+1);
				//document.body.innerHTML += "rudne wygrywa D1<br>"
			}
			else if(deck1[chuj].wartosc < deck2[chuj].wartosc){
				
				//runde wygrywa deck2
				var temp = deck1[chuj];
				deck2.push(temp);
				deck1.splice(chuj,chuj+1);
				deck2.push(deck2[chuj]);
				deck2.splice(chuj,chuj+1);
				//document.body.innerHTML += "rudne wygrywa D2<br>"
			}
			else{
				console.log("wtf");
			}
}
			//	chuj++;
			if(chuj==1)
							{clearInterval(lecimy_tutaj);
							
							if(deck1.length == 0){	
								document.getElementById("decki").innerHTML="KONIEC GRY, wygrywa D2";
							}
							else{
								document.getElementById("decki").innerHTML="KONIEC GRY, wygrywa D1";
							}
							};

			},1)		
		
		/*var safe = 0;
		while (deck1.length > 3 || deck2.length > 3){
			//console.log("chuj");
			render(deck1[0],deck2[0]);
			
			safe++;
			if (safe > 1000){
				console.log("error");
				break;
				
			}
			if (deck1[0].wartosc == deck2[0].wartosc)
				{
					console.log("wojna");
					//alert("wojna " + deck1.length + ":"+deck2.length)
					//wojna(deck1,deck2);
					if(deck1.length > 3 && deck2.length > 3){
						if(deck1[2].wartosc == deck2[2].wartosc)
							{console.log("KURWA");}
						if(deck1[2].wartosc > deck2[2].wartosc)
					{
						
						deck1.push(deck2[2]);
						deck1.push(deck2[1]);
						deck1.push(deck2[0]);
						deck2.splice(0,3);
						deck1.push(deck1[2]);
						deck1.push(deck1[0]);
						deck1.push(deck1[1]);
						deck1.splice(0,3);
					}
					else{
						//runde wygrywa deck2
						deck2.push(deck1[2]);
						deck2.push(deck1[1]);
						deck2.push(deck1[0]);
						deck1.splice(0,3);
						deck2.push(deck2[2]);
						deck2.push(deck2[0]);
						deck2.push(deck2[1]);
						deck2.splice(0,3);
					}
				}
			}
			else if(deck1[0].wartosc > deck2[0].wartosc)
			{
				console.log("peace");
				//usuwanie z deck2, push do deck1
				//usuniecie aktualnej z deck1 i dodanie go na koniec

				var temp = deck2[0];
				deck1.push(temp);
				deck2.splice(0,1);
				deck1.push(deck1[0]);
				deck1.splice(0,1);
			}
			else{
				console.log("peace");
				//runde wygrywa deck2
				var temp = deck1[0];
				deck2.push(temp);
				deck1.splice(0,1);
				deck2.push(deck2[0]);
				deck2.splice(0,1);
			}
		}
		*/
		//console.log(deck1.length+ " "+ deck2.length)
		// KONIEC GRY

		function render(x,y){	
		/*	document.body.innerHTML += "kolor:"+x.kolor+ " wartosc:"+x.wartosc+"<br>"+"kolor: "+y.kolor+ " wartosc:"+y.wartosc+"<br><br>";	
		*/

		}


		function primitive_shuffle(tablica){
			for(var i=0;i<tablica.length;i++)
			{
				var temp = tablica[i];
				var r = Math.floor(Math.random()*tablica.length);
				//console.log(r);
				tablica[i] = tablica[r];
				tablica[r] = temp; 
				
			}
			
		}
	}
</script>
</head>
<body onload="onLoad()">
<div id="decki">
</div>
</body>
</html>