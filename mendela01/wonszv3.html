<html>
<head>
<style>
        body{
    background-color: dimgrey}
table{
        border-collapse: collapse;
    margin: 0 auto;
}
td{
        width:20px;
        height:20px;
        border: 1px;
        font-size: 0px ;
}


</style>
<script>
var n=30;
var tab=[];
var x=parseInt(n/2);
var y=x;
var dlugosc=2;
var state = 0;
var interval;

window.onkeydown = function(e) {
                
                if(state == 0) {
                        interval = setInterval(intFunction, 150)
                }
                if((e.which == 87 || e.which==38) && x>0 && state != 2) {
                        state = 1;
                }
                if((e.which==83 || e.which==40) && x<(n-1) && state != 1) {
                        state = 2;
                }
                if((e.which==65 || e.which==37) && y>0 && state != 4) {
                        state = 3;
                }
                if((e.which==68 || e.which==39) && y<(n-1) && state != 3) {
                        state = 4;
                }                        
        }

    
function intFunction() {
    if(state == 1) {
            x--;                        
    }
    if(state == 2) {
            x++;
    }
    if(state == 3) {
            y--;
    }
    if(state == 4) {
            y++; 
    }
        inc();
		checkwin();
        check();
        zeruj();
        tab[x][y]=1
        
        render();

}
function checkwin(){
        if(tab[x][y]>0){
        	alert("you lose! score: "+(dlugosc-2))
        clearInterval(interval);}
        if(tab[x][y]==-2){
        	alert("you lose! score: "+(dlugosc-2))
            clearInterval(interval);}
        

}

function zeruj(){
		for(i=0;i<n;i++){
                        for(j=0;j<n;j++){
                                if(tab[i][j]>dlugosc)
                                	tab[i][j]=0
                }
        } 
}

function inc(){
	for(i=0;i<n;i++){
        for(j=0;j<n;j++){
                if(tab[i][j]>0)
                	tab[i][j]++
}
} 
}

window.onload=function(){
        var t=document.createElement("table");
        for(i=0;i<n;i++){
                tab[i]=[];
                var tr= document.createElement("tr");
                for(j=0;j<n;j++){
                        tab[i][j]=0
                        var td= document.createElement("td");
                        td.id="k_"+i+"_"+j;
                        tr.appendChild(td);
                }
                t.appendChild(tr)
        }
        document.body.appendChild(t);
        tab[x][y]=1
        render();
        random();
}
 

function render(){
                //blokuj (????)
            for(i=0;i<n;i++){
                        for(j=0;j<n;j++){
                                if(i==0 || i==n-1 || j==0 || j==n-1)
                                tab[i][j]=-2
                }
        }  
        //wypisz wartosci
        for(i=0;i<n;i++){
                for(j=0;j<n;j++)
                        document.getElementById("k_"+i+"_"+j).innerHTML=tab[i][j];
        }
        //kolorki
        for(i=0;i<n;i++){
                for(j=0;j<n;j++){
                        var xxx=document.getElementById("k_"+i+"_"+j);
                    if(tab[i][j]==0){
                    	xxx.style.backgroundColor="#abcdef";
                    	
                    }
                    if(tab[i][j]>0){
                    	xxx.style.backgroundColor="#7FaF00";
                    	
                    }
                    if(tab[i][j]<0){
                    	xxx.style.backgroundColor="#FF4500";
                    	
                    }
                    if(tab[i][j]==-1){
                    	xxx.style.backgroundColor="FFFF00";
                    	
                    }
                    if(tab[i][j]==1){
                    	xxx.style.backgroundColor="#7FFF00";
                    	
                    }
        }
    }



}
function random(){
	xrandom = parseInt(Math.random()*(n-2)+1)
	yrandom = parseInt(Math.random()*(n-2)+1)
		if(tab[xrandom][yrandom]==0)
			tab[xrandom][yrandom] = -1
		else
			random();	
}

function check(){
	if(x==xrandom && y==yrandom){
		dlugosc++;
		random();
	}


}
</script>
</head>
<body>
</body>
</html>